# BitcoinMW - Build, Configuration, and Running

## Supported Platforms

BitcoinMW's programming language `rust` has buildÂ targets for most platforms.
The primary supported platforms are: MacOS, Linux, and Windows. The build pipeline continously checks specifically ubuntu-18.04, macos-latest, windows-latest. We support, but do not test other variants of these OSes at the moment.

## Requirements

* rust: Install using rustup: https://rustup.rs
  * BitcoinMW currently does not support a minimum version of Rust, it is recommended to build using the latest version.
  * If rust is already installed, you can update to the latest version by running `rustup update`.
* clang
* ncurses and libs (ncurses, ncursesw5)
* zlib libs (zlib1g-dev or zlib-devel)
* pkg-config
* libssl-dev
* linux-headers (reported needed on Alpine linux)
* llvm
* tor

For Debian-based distributions (Debian, Ubuntu, Mint, etc), all in one line (except Rust):

```sh
apt install build-essential cmake git libgit2-dev clang libncurses5-dev libncursesw5-dev zlib1g-dev pkg-config libssl-dev llvm tor
```

On some versions of linux, the following is required:

```sh
sudo apt-get install -y libncursesw5
```

For Mac:

```sh
xcode-select --install
brew install --with-toolchain llvm
brew install pkg-config
brew install openssl
brew install tor
```

## Build steps

```sh
git clone https://github.com/bitcoinmw/bitcoinmw.git
cd bitcoinmw
cargo build --release
```

BitcoinMW can also be built in debug mode (without the `--release` flag, but using the `--debug` or the `--verbose` flag) but this will render fast sync prohibitively slow due to the large overhead of cryptographic operations.

## Build errors

See [Troubleshooting](https://github.com/mimblewimble/docs/wiki/Troubleshooting)

## What was built?

A successful build gets you:

* `target/release/bmw` - the main bitcoinmw binary

All data, configuration and log files created and used by bmw are located in the hidden
`~/.bmw` directory (under your user home directory) by default. You can modify all configuration
values by editing the file `~/.bmw/main/bmw-server.toml`.

It is also possible to have bmw create its data files in the current directory. To do this, run

```sh
bmw server config
```

Which will generate a `bmw-server.toml` file in the current directory, pre-configured to use
the current directory for all of its data. Running bmw from a directory that contains a
`bmw-server.toml` file will use the values in that file instead of the default
`~/.bmw/main/bmw-server.toml`.

While testing, put the bmw binary on your path like this:

```sh
export PATH=`pwd`/target/release:$PATH
```

assuming you are running from the root directory of your BitcoinMW installation.

You can then run `bmw` directly (try `bmw help` for more options).

## Configuration

BitcoinMW attempts to run with sensible defaults, and can be further configured via
the `bmw-server.toml` file. This file is generated by bmw on its first run, and
contains documentation on each available option.

While it's recommended that you perform all bmw server configuration via
`bmw-server.toml`, it's also possible to supply command line switches to bmw that
override any settings in the file.

For help on bmw commands and their switches, try:

```sh
bmw help
bmw server --help
bmw client --help
```

## Docker

TODO: need to check docker support.

```sh
docker build -t bmw -f etc/Dockerfile .
```
For testnet, use `etc/Dockerfile.testnet` instead

You can bind-mount your grin cache to run inside the container.

```sh
docker run -it -d -v $HOME/.bmw:/root/.bmw bmw 
```
If you prefer to use a docker named volume, you can pass `-v dotgrin:/root/.bmw` instead.
Using a named volume copies default configurations upon volume creation.

## Cross-platform builds

Rust (cargo) can build grin for many platforms, so in theory running `bmw`
as a validating node on your low powered device might be possible.
To cross-compile `bmw` on a x86 Linux platform and produce ARM binaries,
say, for a Raspberry Pi.

## Using BitcoinMW

The [wiki page](https://github.com/bitcoinmw/docs/wiki) has details about using BitcoinMW.

## Mining in BitcoinMW

A mining guide will be forthcoming. Currently lolminer and grin-miner have been tested.

